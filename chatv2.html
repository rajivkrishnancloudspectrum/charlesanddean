<!DOCTYPE html>
<html>
<head>
    <title>Charles & Dean Finance Assistant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">

    <style>
        body{
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
            background:#f5f7fa;
        }

        /* ===== ChatGPT Style Launcher ===== */
        #chat-container{
            position:fixed;
            bottom:30px;
            right:30px;
            width:380px;
            background:#ffffff;
            border-radius:18px;
            box-shadow:0 25px 50px rgba(0,0,0,0.18);
            padding:24px;
            z-index:9999;
            border:1px solid #e6e8ec;
        }

        .title{
            font-size:20px;
            font-weight:600;
            color:#0d1b2a;
            margin-bottom:6px;
        }

        .subtitle{
            font-size:14px;
            color:#6b7280;
            margin-bottom:18px;
        }

        .chat-input{
            width:100%;
            padding:14px;
            border-radius:12px;
            border:1px solid #d1d5db;
            font-size:14px;
            margin-bottom:12px;
            outline:none;
            transition:0.2s;
        }

        .chat-input:focus{
            border-color:#0d1b2a;
        }

        .primary-btn{
            width:100%;
            padding:12px;
            border-radius:12px;
            background:#0d1b2a;
            color:white;
            font-weight:600;
            border:none;
            cursor:pointer;
            margin-bottom:18px;
            transition:0.2s;
        }

        .primary-btn:hover{
            background:#1b263b;
        }

        .quick-title{
            font-size:13px;
            color:#6b7280;
            margin-bottom:8px;
        }

        .quick-options{
            display:flex;
            flex-wrap:wrap;
            gap:8px;
        }

        .quick-btn{
            padding:8px 12px;
            border-radius:20px;
            border:1px solid #d1d5db;
            background:#f9fafb;
            font-size:12px;
            cursor:pointer;
            transition:0.2s;
        }

        .quick-btn:hover{
            background:#0d1b2a;
            color:white;
            border-color:#0d1b2a;
        }

        /* ===== Fullscreen Salesforce Messaging ===== */
        .embeddedMessagingFrame{
            position:fixed !important;
            top:0 !important;
            left:0 !important;
            right:0 !important;
            bottom:0 !important;
            width:100vw !important;
            height:100vh !important;
            border-radius:0 !important;
            z-index:999999 !important;
        }

        .embeddedMessagingFrame iframe{
            width:100% !important;
            height:100% !important;
        }
    </style>
</head>

<body>

<div id="chat-container">
    <div class="title">Charles & Dean Finance Assistant</div>
    <div class="subtitle">
        Ask anything about vehicle finance, eligibility or applications.
    </div>

    <input type="text" id="chatInput" class="chat-input"
           placeholder="Ask about vehicle finance..." />

    <button id="sendBtn" class="primary-btn">Start Chat</button>

    <div class="quick-title">Quick Options</div>
    <div class="quick-options">
        <button id="orderButton" class="quick-btn">Need vehicle finance help</button>
        <button id="caseButton" class="quick-btn">Check my eligibility</button>
        <button class="quick-btn" onclick="launchChat('Help me choose the right vehicle finance option')">
            Help me choose a plan
        </button>
        <button class="quick-btn" onclick="launchChat('I want to apply for vehicle finance')">
            Start application
        </button>
    </div>
</div>

<script>
function makeMessagingFullScreen(){
    const interval=setInterval(()=>{
        const frame=document.querySelector('.embeddedMessagingFrame');
        if(frame){
            frame.style.top="0";
            frame.style.left="0";
            frame.style.right="0";
            frame.style.bottom="0";
            frame.style.width="100vw";
            frame.style.height="100vh";
            clearInterval(interval);
        }
    },200);
}

function initEmbeddedMessaging(){
    try{
        embeddedservice_bootstrap.settings.language='en_US';
        embeddedservice_bootstrap.settings.hideChatButtonOnLoad=true;

        window.addEventListener("onEmbeddedMessagingConversationOpened",()=>{
            hideChatContainer();
            makeMessagingFullScreen();
        });

        window.addEventListener("onEmbeddedMessagingWindowClosed",()=>{
            showChatContainer();
        });

        window.addEventListener("onEmbeddedMessagingButtonCreated",()=>{
            showChatContainer();
        });

        embeddedservice_bootstrap.init(
            '00DTA00000B1e6j',
            'Web_AI_Agent',
            'https://charlesdean--partialcop.sandbox.my.site.com/ESWWebAIAgent1762338692563',
            { scrt2URL:'https://charlesdean--partialcop.sandbox.my.salesforce-scrt.com' }
        );
    }catch(err){
        console.error('Error loading Embedded Messaging: ',err);
    }
}

function showChatContainer(){
    const el=document.getElementById('chat-container');
    if(el) el.style.display='block';
}

function hideChatContainer(){
    const el=document.getElementById('chat-container');
    if(el) el.style.display='none';
}

function launchChat(message){
    embeddedservice_bootstrap.utilAPI.launchChat()
        .then(()=>{
            if(message){ sendMessageToChat(message); }
        })
        .catch(console.error);
}

function sendMessageToChat(message){
    setTimeout(()=>{
        embeddedservice_bootstrap.utilAPI.sendTextMessage(message)
            .catch(console.error);
    },2000);
}

document.addEventListener('DOMContentLoaded',()=>{
    const sendBtn=document.getElementById('sendBtn');
    const chatInput=document.getElementById('chatInput');
    const orderButton=document.getElementById('orderButton');
    const caseButton=document.getElementById('caseButton');

    sendBtn.addEventListener('click',()=>{
        const msg=chatInput.value.trim();
        if(msg){
            chatInput.value="";
            launchChat(msg);
        }
    });

    chatInput.addEventListener("keypress",(e)=>{
        if(e.key==="Enter") sendBtn.click();
    });

    orderButton.addEventListener('click',()=>{
        launchChat(orderButton.textContent.trim());
    });

    caseButton.addEventListener('click',()=>{
        launchChat(caseButton.textContent.trim());
    });
});
</script>

<script src='https://charlesdean--partialcop.sandbox.my.site.com/ESWWebAIAgent1762338692563/assets/js/bootstrap.min.js'
        onload='initEmbeddedMessaging()'></script>

</body>
</html>
